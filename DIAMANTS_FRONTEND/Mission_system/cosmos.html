<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>◉ COSMOS ORIGINEL</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            overflow: hidden; 
            background: #000; 
            font-family: 'Georgia', serif;
            cursor: crosshair;
        }
        canvas { display: block; }
        
        #meditation {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: rgba(255, 255, 255, 0.7);
            font-size: 18px;
            text-align: center;
            z-index: 1000;
            pointer-events: none;
            opacity: 1;
            transition: opacity 3s ease;
            text-shadow: 0 0 20px rgba(136, 0, 255, 0.5);
            letter-spacing: 2px;
            line-height: 2;
        }
        
        #meditation.hidden {
            opacity: 0;
        }
        
        #hud {
            position: fixed;
            bottom: 20px;
            left: 20px;
            color: rgba(136, 0, 255, 0.6);
            font-size: 11px;
            font-family: 'Courier New', monospace;
            z-index: 1000;
            letter-spacing: 1px;
        }
        
        #harmonics {
            position: fixed;
            top: 20px;
            right: 20px;
            color: rgba(255, 255, 255, 0.4);
            font-size: 10px;
            font-family: 'Courier New', monospace;
            z-index: 1000;
            text-align: right;
            line-height: 1.8;
        }
        
        .layer-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <div id="meditation">
        Avant le temps<br>
        Avant l'espace<br>
        Il y avait la vibration pure<br>
        <br>
        ◉
    </div>
    
    <div id="harmonics">
        <div><span class="layer-indicator" style="background: #8800ff;"></span>H₁ φ⁰</div>
        <div><span class="layer-indicator" style="background: #0044ff;"></span>H₂ φ¹</div>
        <div><span class="layer-indicator" style="background: #00ddff;"></span>H₃ φ²</div>
        <div><span class="layer-indicator" style="background: #00ff88;"></span>H₄ φ³</div>
        <div><span class="layer-indicator" style="background: #ffff00;"></span>H₅ φ⁴</div>
        <div><span class="layer-indicator" style="background: #ff8800;"></span>H₆ φ⁵</div>
        <div><span class="layer-indicator" style="background: #ff0044;"></span>H₇ φ⁶</div>
    </div>
    
    <div id="hud">
        COSMOS ORIGINEL<br>
        7 couches harmoniques<br>
        ~36000 particules
    </div>
    
    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { CosmosOriginel } from './core/cosmos-originel.js';
        
        // === SCENE ===
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x000005);
        
        // === CAMERA ===
        const camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 500);
        camera.position.set(0, 0, 80);
        camera.lookAt(0, 0, 0);
        
        // === RENDERER ===
        const renderer = new THREE.WebGLRenderer({ 
            antialias: true,
            powerPreference: 'high-performance'
        });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        renderer.toneMapping = THREE.ACESFilmicToneMapping;
        renderer.toneMappingExposure = 1.2;
        document.body.appendChild(renderer.domElement);
        
        // === CONTROLS ===
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.03;
        controls.rotateSpeed = 0.3;
        controls.zoomSpeed = 0.5;
        controls.minDistance = 10;
        controls.maxDistance = 200;
        controls.autoRotate = true;
        controls.autoRotateSpeed = 0.15;
        
        // === COSMOS ===
        const cosmos = new CosmosOriginel(scene, {
            harmonicLayers: 7,
            particlesPerLayer: 5000,
            breathingRate: 0.25
        });
        
        // === MEDITATION TEXT ===
        const meditation = document.getElementById('meditation');
        setTimeout(() => {
            meditation.classList.add('hidden');
        }, 6000);
        
        // === MUSIC (ambient frequencies) ===
        let audioContext = null;
        let oscillators = [];
        
        function initAudio() {
            if (audioContext) return;
            
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const masterGain = audioContext.createGain();
            masterGain.gain.value = 0.03;
            masterGain.connect(audioContext.destination);
            
            // Fréquences harmoniques basées sur le nombre d'or
            const baseFreq = 55; // La grave
            const phi = 1.618033988749895;
            const frequencies = [
                baseFreq,
                baseFreq * phi,
                baseFreq * phi * phi,
                baseFreq * 2,
                baseFreq * 2 * phi,
            ];
            
            frequencies.forEach((freq, i) => {
                const osc = audioContext.createOscillator();
                const gain = audioContext.createGain();
                
                osc.type = 'sine';
                osc.frequency.value = freq;
                gain.gain.value = 0.15 / (i + 1);
                
                osc.connect(gain);
                gain.connect(masterGain);
                osc.start();
                
                oscillators.push({ osc, gain });
            });
        }
        
        // Activer l'audio au premier clic
        document.addEventListener('click', () => {
            initAudio();
        }, { once: true });
        
        // === ANIMATION ===
        let lastTime = performance.now();
        
        function animate() {
            requestAnimationFrame(animate);
            
            const now = performance.now();
            const dt = (now - lastTime) / 1000;
            lastTime = now;
            
            cosmos.update(dt);
            controls.update();
            
            // Modulation audio subtile
            if (oscillators.length > 0) {
                const breathe = Math.sin(now * 0.0003) * 0.5 + 0.5;
                oscillators.forEach((o, i) => {
                    o.gain.gain.value = (0.1 + breathe * 0.05) / (i + 1);
                });
            }
            
            renderer.render(scene, camera);
        }
        
        // === RESIZE ===
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
        
        // === KEYBOARD ===
        window.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                controls.autoRotate = !controls.autoRotate;
            }
            if (e.code === 'KeyM') {
                meditation.classList.toggle('hidden');
            }
        });
        
        // === START ===
        console.log(`
        ╔═══════════════════════════════════╗
        ║      COSMOS ORIGINEL              ║
        ║                                   ║
        ║  "Au commencement était          ║
        ║   la vibration..."               ║
        ║                                   ║
        ║  7 harmoniques • φ ratio         ║
        ║  Click pour l'audio              ║
        ╚═══════════════════════════════════╝
        `);
        
        animate();
    </script>
</body>
</html>
