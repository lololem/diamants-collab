# Configuration pour le Map Merger Node
# Paramètres de fusion collaborative de cartes multi-drones

# === Configuration des robots ===
swarm:
  robot_prefixes: ['crazyflie', 'crazyflie1', 'crazyflie2', 'crazyflie3', 'crazyflie4', 'crazyflie5', 'crazyflie6', 'crazyflie7']
  max_robots: 8
  use_sim_time: true

# === Paramètres de phéromones ===
pheromones:
  increment: 15        # Augmentation phéromone sur obstacle détecté
  decrement: 5         # Diminution phéromone sur espace libre
  evaporation: 0.3     # Taux d'évaporation par tick
  max_value: 100       # Valeur maximale de phéromone
  min_value: 0         # Valeur minimale de phéromone
  obstacle_bonus: 10   # Bonus pour obstacles persistants
  free_penalty: 20     # Pénalité pour espaces libres confirmés

# === Paramètres de stabilité ===
stability:
  state_change_max: 20    # Nombre max de changements d'état autorisés
  min_cluster_size: 3     # Taille minimale des clusters d'obstacles
  observation_threshold: 8 # Seuil minimum d'observations pour valider

# === Traitement morphologique ===
morphology:
  enable: true           # Activer le traitement morphologique
  kernel_size: 3         # Taille du noyau morphologique (3x3)
  iterations: 1          # Nombre d'itérations d'ouverture
  erosion_threshold: 100 # Seuil minimal de pixels pour l'érosion

# === Filtrage temporel ===
temporal:
  smoothing_window: 5    # Fenêtre de lissage temporel
  fusion_history: 7      # Historique pour moyenne glissante
  stability_window: 3    # Fenêtre de stabilité pour hystérésis

# === Pondération des fusions ===
fusion_weights:
  merged: 0.4           # Poids pour données fusionnées
  validated: 0.3        # Poids pour données validées
  consensus: 0.2        # Poids pour consensus multi-robots
  union: 0.1            # Poids pour union des cartes

# === Filtres avancés ===
filters:
  use_kalman: true      # Activer filtre de Kalman
  kalman_process_noise: 0.01
  kalman_measurement_noise: 0.1
  
  use_fusion: true      # Activer fusion pondérée
  anti_false_positive: true  # Anti-faux positifs

# === Paramètres de consensus ===
consensus:
  min_robots: 2         # Minimum de robots pour consensus
  tolerance: 0.5        # Tolérance pour accord multi-robots

# === Topics et namespaces ===
topics:
  input_maps: "/map"    # Topic d'entrée des cartes individuelles
  output_merged: "/map_merged"
  output_consensus: "/map_merged_consensus" 
  output_validated: "/map_merged_validated"
  output_weighted: "/map_fusion_weighted"

# === Paramètres de logging ===
logging:
  enable_csv: true      # Activer logs CSV
  csv_path: "/tmp"      # Répertoire des logs CSV
  debug_level: "info"   # Niveau de debug (debug, info, warn, error)
  log_frequency: 10     # Fréquence de log (tous les N ticks)

# === Optimisations ===
performance:
  max_update_rate: 10.0 # Fréquence max de mise à jour (Hz)
  memory_limit_mb: 512  # Limite mémoire en MB
  parallel_processing: true  # Traitement parallèle si possible
